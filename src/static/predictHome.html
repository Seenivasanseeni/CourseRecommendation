<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Predict</title>
    <style>
        .container-horizontal{
            display: flex;
        }
        .container-entry{
            text-align: center;
        }
        .container-entry.form{
            width: 60%;
        }
    </style>
</head>
<body>
    <div class="container-horizontal">
        <div class="container-entry form">
            <form action="/predict" method="post" >
                <label for="id">ID</label>
                <input type="text" name="id" id="id" /> <br /><br />
                <label for="fi">FI</label>
                <input type="text" name="fi" id="fi" /> <br /><br />
                <label for="subject1">Elective 1 Subject</label>
                <input type="text" class="subject" name="subject1"><br /><br />
                <label for="subject2">Elective 2 Subject</label>
                <input type="text" class="subject" name="subject2"><br /><br />
                <label for="subject3">Elective 3 Subject</label>
                <input type="text" class="subject" name="subject3"><br /><br />
                <button type="submit" id="submit">Submit</button>
            </form>
        </div>
        <div class="container-entry">
            <h1>Next Subject</h1>
            <div id="nextSubject">

            </div>
        </div>
    </div>
    <script>
        var model={};
        var sendRequest=function (e) {
            e.preventDefault();
            var id=document.getElementById("id").value;
            var fi=document.getElementById("fi").value;
            var subjects_raw=document.getElementsByClassName("subject");
            var subjects=[];
            for(let i=0;i<subjects_raw.length;i++){
                sub=subjects_raw[i];
                if(sub.value ==""){
                   // subjects.push("None");
                }
                else
                    subjects.push(sub.value);
            }
            var student={
                "ID":id,
                "FI":fi,
                "S":subjects
            };
            var asyncRequest= new XMLHttpRequest();
            asyncRequest.open(method="POST",url="/predict");
            asyncRequest.setRequestHeader("Content-Type","application/json;charset=utf-8");
            asyncRequest.onload=function (response) {

                if(this.status>=400) {
                    document.getElementById("nextSubject").innerText = "Error happened in Server. Not expected behaviour from Client ";
                    return;
                }
                console.log("Next Subject:",this.response);
                var data=JSON.parse(this.response);
                document.getElementById("nextSubject").innerText=data.nextSubject;
                if(data.status==2) //max Difficutly #todo change status to numbers
                    document.getElementById("nextSubject").innerText="It looks like you mastered the field . Try doing projects(recommendated)  Or take basic courses to brush up your basics Or learn some other field course which will help you later in your life";
                if(data.status==1)
                    document.getElementById("nextSubject").innerText="Error in Input. Use Capitals and only valid subjects codes";
                model=data;
            };
            asyncRequest.onerror=function (ev) {
                document.getElementById("nextSubject").innerText="Error Happened. Try contacting the Admin";
            }
            asyncRequest.send(JSON.stringify(student));
        };
        document.getElementById("submit").addEventListener("click",sendRequest);
    </script>
</body>
</html>
